import{_ as Ve,o as Be,r as ue,a as Xe,b as Ze,c as We,d as J,e as ee,f as x,F as me,g as Ce,h as B,w as X,n as Ge,i as qe,v as Qe,t as Je,j as et,k as Z,p as tt,l as nt}from"./index-70efd727.js";import{E as ot,V as D,M as $,T as U,Q as Ae,S as Se,a as T,b as at,C as it,P as te,D as st,A as lt,W as ne,F as rt,R as ct,c as dt,G as ut,d as pe,e as mt,B as Le,f as ke,g as pt}from"./index-8447cd6e.js";const De={type:"change"},he={type:"start"},Ne={type:"end"};class ht extends ot{constructor(m,g){super(),this.object=m,this.domElement=g,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new D,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:$.ROTATE,MIDDLE:$.DOLLY,RIGHT:$.PAN},this.touches={ONE:U.ROTATE,TWO:U.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",ce),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ce),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(De),e.update(),d=s.NONE},this.update=function(){const t=new D,a=new Ae().setFromUnitVectors(m.up,new D(0,1,0)),f=a.clone().invert(),y=new D,v=new Ae,K=2*Math.PI;return function(){const Oe=e.object.position;t.copy(Oe).sub(e.target),t.applyQuaternion(a),l.setFromVector3(t),e.autoRotate&&d===s.NONE&&H(W()),e.enableDamping?(l.theta+=u.theta*e.dampingFactor,l.phi+=u.phi*e.dampingFactor):(l.theta+=u.theta,l.phi+=u.phi);let L=e.minAzimuthAngle,k=e.maxAzimuthAngle;return isFinite(L)&&isFinite(k)&&(L<-Math.PI?L+=K:L>Math.PI&&(L-=K),k<-Math.PI?k+=K:k>Math.PI&&(k-=K),L<=k?l.theta=Math.max(L,Math.min(k,l.theta)):l.theta=l.theta>(L+k)/2?Math.max(L,l.theta):Math.min(k,l.theta)),l.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=M,l.radius=Math.max(e.minDistance,Math.min(e.maxDistance,l.radius)),e.enableDamping===!0?e.target.addScaledVector(P,e.dampingFactor):e.target.add(P),t.setFromSpherical(l),t.applyQuaternion(f),Oe.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(u.theta*=1-e.dampingFactor,u.phi*=1-e.dampingFactor,P.multiplyScalar(1-e.dampingFactor)):(u.set(0,0,0),P.set(0,0,0)),M=1,O||y.distanceToSquared(e.object.position)>b||8*(1-v.dot(e.object.quaternion))>b?(e.dispatchEvent(De),y.copy(e.object.position),v.copy(e.object.quaternion),O=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",ve),e.domElement.removeEventListener("pointerdown",_e),e.domElement.removeEventListener("pointercancel",xe),e.domElement.removeEventListener("wheel",Pe),e.domElement.removeEventListener("pointermove",le),e.domElement.removeEventListener("pointerup",re),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",ce),e._domElementKeyEvents=null)};const e=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=s.NONE;const b=1e-6,l=new Se,u=new Se;let M=1;const P=new D;let O=!1;const E=new T,w=new T,_=new T,C=new T,S=new T,A=new T,N=new T,F=new T,R=new T,i=[],I={};function W(){return 2*Math.PI/60/60*e.autoRotateSpeed}function z(){return Math.pow(.95,e.zoomSpeed)}function H(t){u.theta-=t}function o(t){u.phi-=t}const n=function(){const t=new D;return function(f,y){t.setFromMatrixColumn(y,0),t.multiplyScalar(-f),P.add(t)}}(),c=function(){const t=new D;return function(f,y){e.screenSpacePanning===!0?t.setFromMatrixColumn(y,1):(t.setFromMatrixColumn(y,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(f),P.add(t)}}(),p=function(){const t=new D;return function(f,y){const v=e.domElement;if(e.object.isPerspectiveCamera){const K=e.object.position;t.copy(K).sub(e.target);let Q=t.length();Q*=Math.tan(e.object.fov/2*Math.PI/180),n(2*f*Q/v.clientHeight,e.object.matrix),c(2*y*Q/v.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(n(f*(e.object.right-e.object.left)/e.object.zoom/v.clientWidth,e.object.matrix),c(y*(e.object.top-e.object.bottom)/e.object.zoom/v.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function h(t){e.object.isPerspectiveCamera?M/=t:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*t)),e.object.updateProjectionMatrix(),O=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function r(t){e.object.isPerspectiveCamera?M*=t:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/t)),e.object.updateProjectionMatrix(),O=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function Y(t){E.set(t.clientX,t.clientY)}function oe(t){N.set(t.clientX,t.clientY)}function j(t){C.set(t.clientX,t.clientY)}function G(t){w.set(t.clientX,t.clientY),_.subVectors(w,E).multiplyScalar(e.rotateSpeed);const a=e.domElement;H(2*Math.PI*_.x/a.clientHeight),o(2*Math.PI*_.y/a.clientHeight),E.copy(w),e.update()}function ae(t){F.set(t.clientX,t.clientY),R.subVectors(F,N),R.y>0?h(z()):R.y<0&&r(z()),N.copy(F),e.update()}function ie(t){S.set(t.clientX,t.clientY),A.subVectors(S,C).multiplyScalar(e.panSpeed),p(A.x,A.y),C.copy(S),e.update()}function fe(t){t.deltaY<0?r(z()):t.deltaY>0&&h(z()),e.update()}function ye(t){let a=!1;switch(t.code){case e.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?o(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):p(0,e.keyPanSpeed),a=!0;break;case e.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?o(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):p(0,-e.keyPanSpeed),a=!0;break;case e.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?H(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):p(e.keyPanSpeed,0),a=!0;break;case e.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?H(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):p(-e.keyPanSpeed,0),a=!0;break}a&&(t.preventDefault(),e.update())}function q(){if(i.length===1)E.set(i[0].pageX,i[0].pageY);else{const t=.5*(i[0].pageX+i[1].pageX),a=.5*(i[0].pageY+i[1].pageY);E.set(t,a)}}function se(){if(i.length===1)C.set(i[0].pageX,i[0].pageY);else{const t=.5*(i[0].pageX+i[1].pageX),a=.5*(i[0].pageY+i[1].pageY);C.set(t,a)}}function be(){const t=i[0].pageX-i[1].pageX,a=i[0].pageY-i[1].pageY,f=Math.sqrt(t*t+a*a);N.set(0,f)}function Ie(){e.enableZoom&&be(),e.enablePan&&se()}function Re(){e.enableZoom&&be(),e.enableRotate&&q()}function ge(t){if(i.length==1)w.set(t.pageX,t.pageY);else{const f=de(t),y=.5*(t.pageX+f.x),v=.5*(t.pageY+f.y);w.set(y,v)}_.subVectors(w,E).multiplyScalar(e.rotateSpeed);const a=e.domElement;H(2*Math.PI*_.x/a.clientHeight),o(2*Math.PI*_.y/a.clientHeight),E.copy(w)}function Ee(t){if(i.length===1)S.set(t.pageX,t.pageY);else{const a=de(t),f=.5*(t.pageX+a.x),y=.5*(t.pageY+a.y);S.set(f,y)}A.subVectors(S,C).multiplyScalar(e.panSpeed),p(A.x,A.y),C.copy(S)}function we(t){const a=de(t),f=t.pageX-a.x,y=t.pageY-a.y,v=Math.sqrt(f*f+y*y);F.set(0,v),R.set(0,Math.pow(F.y/N.y,e.zoomSpeed)),h(R.y),N.copy(F)}function ze(t){e.enableZoom&&we(t),e.enablePan&&Ee(t)}function He(t){e.enableZoom&&we(t),e.enableRotate&&ge(t)}function _e(t){e.enabled!==!1&&(i.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",le),e.domElement.addEventListener("pointerup",re)),Ue(t),t.pointerType==="touch"?Ke(t):Ye(t))}function le(t){e.enabled!==!1&&(t.pointerType==="touch"?$e(t):je(t))}function re(t){Te(t),i.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",le),e.domElement.removeEventListener("pointerup",re)),e.dispatchEvent(Ne),d=s.NONE}function xe(t){Te(t)}function Ye(t){let a;switch(t.button){case 0:a=e.mouseButtons.LEFT;break;case 1:a=e.mouseButtons.MIDDLE;break;case 2:a=e.mouseButtons.RIGHT;break;default:a=-1}switch(a){case $.DOLLY:if(e.enableZoom===!1)return;oe(t),d=s.DOLLY;break;case $.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;j(t),d=s.PAN}else{if(e.enableRotate===!1)return;Y(t),d=s.ROTATE}break;case $.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;Y(t),d=s.ROTATE}else{if(e.enablePan===!1)return;j(t),d=s.PAN}break;default:d=s.NONE}d!==s.NONE&&e.dispatchEvent(he)}function je(t){switch(d){case s.ROTATE:if(e.enableRotate===!1)return;G(t);break;case s.DOLLY:if(e.enableZoom===!1)return;ae(t);break;case s.PAN:if(e.enablePan===!1)return;ie(t);break}}function Pe(t){e.enabled===!1||e.enableZoom===!1||d!==s.NONE||(t.preventDefault(),e.dispatchEvent(he),fe(t),e.dispatchEvent(Ne))}function ce(t){e.enabled===!1||e.enablePan===!1||ye(t)}function Ke(t){switch(Me(t),i.length){case 1:switch(e.touches.ONE){case U.ROTATE:if(e.enableRotate===!1)return;q(),d=s.TOUCH_ROTATE;break;case U.PAN:if(e.enablePan===!1)return;se(),d=s.TOUCH_PAN;break;default:d=s.NONE}break;case 2:switch(e.touches.TWO){case U.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Ie(),d=s.TOUCH_DOLLY_PAN;break;case U.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Re(),d=s.TOUCH_DOLLY_ROTATE;break;default:d=s.NONE}break;default:d=s.NONE}d!==s.NONE&&e.dispatchEvent(he)}function $e(t){switch(Me(t),d){case s.TOUCH_ROTATE:if(e.enableRotate===!1)return;ge(t),e.update();break;case s.TOUCH_PAN:if(e.enablePan===!1)return;Ee(t),e.update();break;case s.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;ze(t),e.update();break;case s.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;He(t),e.update();break;default:d=s.NONE}}function ve(t){e.enabled!==!1&&t.preventDefault()}function Ue(t){i.push(t)}function Te(t){delete I[t.pointerId];for(let a=0;a<i.length;a++)if(i[a].pointerId==t.pointerId){i.splice(a,1);return}}function Me(t){let a=I[t.pointerId];a===void 0&&(a=new T,I[t.pointerId]=a),a.set(t.pageX,t.pageY)}function de(t){const a=t.pointerId===i[0].pointerId?i[1]:i[0];return I[a.pointerId]}e.domElement.addEventListener("contextmenu",ve),e.domElement.addEventListener("pointerdown",_e),e.domElement.addEventListener("pointercancel",xe),e.domElement.addEventListener("wheel",Pe,{passive:!1}),this.update()}}const Fe=V=>(tt("data-v-30250fef"),V=V(),nt(),V),ft={class:"main"},yt={class:"plandiv"},bt={style:{display:"flex","align-items":"center","justify-content":"center"}},gt=["onClick"],Et=Fe(()=>x("div",{id:"cube"},null,-1)),wt=Fe(()=>x("div",{class:"lowerview"},[x("div",{id:"xview",class:"loverchild"}),x("div",{id:"zview",class:"loverchild"}),x("div",{id:"yview",class:"loverchild"})],-1)),_t={class:"menu"},xt={class:"menuchild"},Pt={class:"menuchild"},vt={__name:"Cube",setup(V){let m,g,e,s;Be(()=>{S()});const d=[],b={},l=ue("add"),u=ue([]);let M,P,O,E,w,_;const C=ue(!1),S=()=>{let o=document.getElementById("cube");m=new at,m.background=new it(15658734),g=new te(75,o.clientWidth/o.clientHeight,.1,1e3);const n=new st(16777215,.6);n.position.set(10,315,-1),n.castShadow=!0,n.shadow.camera.near=.01,n.shadow.camera.far=500,n.shadow.camera.right=30,n.shadow.camera.left=-30,n.shadow.camera.top=30,n.shadow.camera.bottom=-30,n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.radius=4,n.shadow.bias=-6e-5,m.add(n);const c=new lt(16777215,.8);m.add(c),e=new ne,e.setSize(o.clientWidth,o.clientHeight),o.appendChild(e.domElement),new ht(g,e.domElement);const p=16777215,h=1,r=300;m.fog=new rt(p,h,r);let Y=[];new T,document.addEventListener("click",oe);function oe(G){let ae=(G.clientX-o.getBoundingClientRect().left)/o.offsetWidth*2-1,ie=-((G.clientY-o.getBoundingClientRect().top)/o.offsetHeight)*2+1,q=new D(ae,ie,1).unproject(g).sub(g.position).normalize();Y=new ct(g.position,q).intersectObjects(m.children,!0),Y.length>0&&(l.value=="add"&&I(Y[0].object),l.value=="remove"&&W(Y[0].object))}const j=new dt(12);j.material.opacity=0,j.material.transparent=!0,m.add(j),new ut(70,7,16729344,3289670),R(),A(),i(),z()},A=()=>{N({x:-52.543075151860265,y:40.738162682910044,z:-37.857170134415995},{x:-2.2779439190931385,y:-.6581537877780992,z:-2.5203812613958974})},N=(o,n)=>{g.position.x=o.x,g.position.y=o.y,g.position.z=o.z,g.rotation.x=n.x,g.rotation.y=n.y,g.rotation.z=n.z},F=(o,n)=>{l.value=="add"&&(u.value[o][n]==0?I(d[o*7+n].obj):I(b[`${o}__${n}`][b[`${o}__${n}`].length-1])),l.value=="remove"&&u.value[o][n]>0&&W(b[`${o}__${n}`][b[`${o}__${n}`].length-1])},R=()=>{document.getElementById("cube"),E=new ne({antialias:!0});let o=document.getElementById("xview");E.setSize(o.clientWidth,o.clientHeight),E.setClearColor("#FFFFFF",1),o.appendChild(E.domElement),_=new ne({antialias:!0});let n=document.getElementById("zview");_.setSize(n.clientWidth,n.clientHeight),_.setClearColor("#FFFFFF",1),n.appendChild(_.domElement),w=new ne({antialias:!0});let c=document.getElementById("yview");w.setSize(c.clientWidth,c.clientHeight),w.setClearColor("#FFFFFF",1),c.appendChild(w.domElement),M=new te(75,o.clientWidth/o.clientHeight,.1,1e3),O=new te(75,n.clientWidth/n.clientHeight,.1,1e3),P=new te(75,c.clientWidth/c.clientHeight,.1,1e3),M.position.set(70,0,0),M.lookAt(0,0,0),P.position.set(0,50,0),P.lookAt(0,0,0),O.position.set(0,0,70),O.lookAt(0,0,0),E.render(m,M),_.render(m,O),w.render(m,P)},i=()=>{u.value=[];for(let o=0;o<7;o++){u.value.push([]);for(let n=0;n<7;n++){u.value[o].push(0);const c=new pe({color:7829367}),p=new pe({color:14540253});c.side=mt;const h=new Le(10,10,1),r=new ke(h,o%2==0&&n%2==0||o%2==1&&n%2==1?c:p);r.receiveShadow=!0,r.rotation.x=-Math.PI/2,r.position.x+=-30+o*10,r.position.z+=-30+n*10,r.name=`cube__${o}__${n}`,m.add(r),d.push({obj:r,name:r.name,indx:[o,n],position:{x:r.position.x,z:r.position.z}})}}},I=o=>{let n=o.position;const c=new pe({color:16776849}),p=new Le(10,10,10),h=new ke(p,c);if(h.position.x=n.x,h.position.z=n.z,h.position.y=n.y==0?n.y+5:n.y+10,console.log(u.value),o.name.includes("cube__")||o.name.includes("addbox__")){let r=o.name.split("__");u.value[r[1]][r[2]]++,h.name=`addbox__${r[1]}__${[r[2]]}__${o.uuid}`,b[`${r[1]}__${[r[2]]}`]||(b[`${r[1]}__${[r[2]]}`]=[]),b[`${r[1]}__${[r[2]]}`]=b[`${r[1]}__${[r[2]]}`].concat([h])}C.value=!0,m.add(h)},W=o=>{if(o.name.includes("addbox")){if(o.name.includes("cube__")||o.name.includes("addbox__")){let n=o.name.split("__");u.value[n[1]][n[2]]&&(u.value[n[1]][n[2]]--,b[`${n[1]}__${[n[2]]}`].pop())}m.remove(o),o.geometry.dispose(),o=null}},z=()=>{s=requestAnimationFrame(z),e.render(m,g),E.render(m,M),w.render(m,P),_.render(m,O)},H=()=>{for(let o in b)b[o].forEach(n=>{let c=n.name.split("__");u.value[c[1]][c[2]]&&u.value[c[1]][c[2]]--,m.remove(n),n.geometry.dispose(),n=null});b=null,A()};return Xe(()=>{pt(m,e,s)}),Ze(()=>{console.log("Cube组件卸载了")}),(o,n)=>{const c=We("Button");return J(),ee(me,null,[x("div",ft,[x("div",yt,[x("div",bt,[(J(),ee(me,null,Ce(7,p=>x("div",null,[(J(),ee(me,null,Ce(7,h=>x("div",{class:Ge(["dombox",(p-1)%2==0&&(h-1)%2==0||(p-1)%2==1&&(h-1)%2==1?"white":"dark"]),onClick:r=>F(p-1,h-1)},[C.value?qe((J(),ee("div",{key:0,style:{width:"70px"}},Je(u.value[p-1][h-1]),513)),[[Qe,u.value[p-1][h-1]>0]]):et("",!0)],10,gt)),64))])),64))])]),Et]),wt,x("div",_t,[x("div",xt,[B(c,{type:"primary",onClick:A},{default:X(()=>[Z("重置视角")]),_:1}),B(c,{type:"primary",onClick:H},{default:X(()=>[Z("重置场景")]),_:1})]),x("div",Pt,[B(c,{type:l.value=="add"?"primary":"success",onClick:n[0]||(n[0]=p=>l.value="add")},{default:X(()=>[Z("增加")]),_:1},8,["type"]),B(c,{type:l.value=="remove"?"primary":"success",onClick:n[1]||(n[1]=p=>l.value="remove")},{default:X(()=>[Z("移除")]),_:1},8,["type"]),B(c,{type:l.value=="normal"?"primary":"success",onClick:n[2]||(n[2]=p=>l.value="normal")},{default:X(()=>[Z("重置")]),_:1},8,["type"])])])],64)}}},Ot=Ve(vt,[["__scopeId","data-v-30250fef"]]);export{Ot as default};
